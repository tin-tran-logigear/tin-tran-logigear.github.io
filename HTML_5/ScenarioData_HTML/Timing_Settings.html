<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- InstanceBegin template="/Templates/control.dwt" codeOutsideHTMLIsLocked="false" -->
<head runat="server">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- InstanceBeginEditable name="doctitle" -->
    <title>Standard Control</title>
    <script src="../Scripts/js/jquery-1.5.2.min.js" type="text/javascript"></script>


    <style type="text/css">
        body {
            background-image: url(../images/background.jpg);
        }

        html, body, #wrapper {
            border-style: none; border-color: inherit; border-width: medium; height: 440px;
            width: 100%;
            margin: 0;
            padding: 0;
            white-space: 0;
        }

        .style1 {
            color: #FFFFFF;
            font-weight: bold;
            font-family: Tahoma;
            font-size: 15px;
        }

        .style2 {
            color: red;
            font-weight: bold;
            font-family: Tahoma;
            font-size: 15px;
        }

        .style3 {
            color: #00F;
            font-family: Tahoma;
            font-size: 12px;
        }

        .style4 {
            color: #00F;
            font-weight: bold;
            font-family: Tahoma;
            font-size: 13px;
        }

        a:link {
            COLOR: #FFFFFF;
            text-decoration: none;
        }

        a:visited {
            COLOR: #FFFFFF;
        }

        a:hover {
            COLOR: #FFFFFF;
        }

        a:active {
            COLOR: #FFFFFF;
        }

        a {
            display: block;
        }

        label {
            display: block;
        }

        #Text3 {
            width: 101px;
            text-align: center;
        }

        .auto-style1 {
            text-align: right;
        }

        .auto-style2 {
            text-align: left;
        }
        #btnInteractive0 { width: 96px; }
        .auto-style3 { height: 5%; }
        .auto-style4 { height: 11%; }
        .auto-style5 { height: 18%; }
    </style>
</head>
<body>
    <table id="wrapper" cellspacing="0">
        <tr>
            <td colspan="4" align="right" height="15%"></td>
        </tr>
        <tr>
            <td width="25%" height="62%" rowspan="7"></td>
            <td width="25%" height="5%" align="left" bgcolor="#0000CC">
                <blockquote><span class="style1">Standard Control</span></blockquote>
            </td>
            <td width="26%" height="5%" align="right" bgcolor="#0000CC">
                <!-- InstanceBeginEditable name="Home" -->
                <blockquote><span class="style1"><a href="../index.html">Home</a></span></blockquote>
                <!-- InstanceEndEditable -->
            </td>
            <td width="24%" height="70%" rowspan="7"></td>
        </tr>

        <tr>
            <td colspan="2" valign="bottom" bgcolor="#FFFFFF" height="4%">
                <blockquote><span class="style2">Timing settings </span></blockquote>
            </td>
        </tr>
        <tr>
            <td colspan="2" valign="top" bgcolor="#FFFFFF" height="7%" align="center">

                &nbsp;</tr>
        <tr>
            <td colspan="2" id="PropertyCell" valign="top" bgcolor="#FFFFFF" height="10%">
                <table style="width: 100%;">
                                        <tr>
                        <td class="auto-style1">Window wait time (s):</td>
                        <td class="auto-style2">
                            <input type="text" id="txtWindowWait" name="txtDelay1" size="15" value="30" /></td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                    </tr>
                                        <tr>
                        <td class="auto-style1">Page wait time (s)<span style="font-family: Tahoma; font-size: 12px; color: Black; font-weight: normal;" align="left">:</span></td>
                        <td class="auto-style2">
                            <input type="text" id="txtPageWait" name="txtDelay" size="15" value="30" /></td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                                        </tr>
                                        <tr>-
                        <td class="auto-style1">Page state:</td>
                        <td class="auto-style2">
                        <select id="listPageState" name="D1">
	                        <option value="loading">loading</option>
	                        <option value="interactive">interactive</option>
                        </select></td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                                        </tr>
                                        <tr>
                        <td class="auto-style1">Object wait time (s)<span style="font-family: Tahoma; font-size: 12px; color: Black; font-weight: normal;" align="left">:</span></td>
                        <td class="auto-style2">
                            <input type="text" id="txtObjectWait" name="txtDelay0" size="15" value="30" /></td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                                        </tr>
                                        <tr>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                                        </tr>
                    <tr>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            &nbsp;</td>
                        <td class="auto-style1">&nbsp;</td>
                        <td class="auto-style2">
                            <input type="button" id="btnApply" value="Apply" onclick="btnApply_Click();" /></td>
                        <td align="right" style="text-align: left">
                            &nbsp;</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="2" valign="top" bgcolor="#FFFFFF" align="center" class="auto-style4">
        </tr>
        <tr>
            <td colspan="2" valign="top" bgcolor="#FFFFFF" class="auto-style3">
                <!-- InstanceBeginEditable name="Row6" -->
                

                <!-- InstanceEndEditable -->
            </td>
        </tr>
        <tr>
            <td colspan="4" align="right" height="19%" class="auto-style5"><span class="style3"></span></td>
        </tr>
    </table>
    <script type="text/javascript">
		
		var _varWinWait;
        var _varPageWait;
        var _varObjWait;		
		var _selectedState;
		
		var _pageWaitInterval;
		var _objectWaitInterval;		
		
        function btnApply_Click() {
			
			clearInterval(_pageWaitInterval);
			clearInterval(_objectWaitInterval);
			
			_varWinWait = document.getElementById("txtWindowWait").value * 1000;
            _varPageWait = document.getElementById("txtPageWait").value * 1000;
            _varObjWait = document.getElementById("txtObjectWait").value * 1000;
			var lstState = document.getElementById("listPageState");
			if(lstState.selectedIndex < 0) return;
			_selectedState = lstState.options[lstState.selectedIndex].value;
			
            if (!isInt(_varWinWait) || !isInt(_varPageWait) || !isInt(_varObjWait)) {
                alert("Must be an integer.");
                return;
            }
			if( _varPageWait >= 45000 && _selectedState == "interactive") {
				alert("Limitation: Maximum timeout of interactive state is 45 seconds.");
				return;
			}
			var btnApply = document.getElementById("btnApply");
			btnApply.disabled = true;
			document.body.style.cursor = 'wait';
			winWaitInterval = setInterval(function () { clearInterval(winWaitInterval);  btnApply.disabled = false; document.body.style.cursor = 'default';showWindow(); }, _varWinWait);			
        }
		
		function showWindow()
		{
			if (_selectedState == "loading") {				
				showPageLoading();
			}
			else if (_selectedState == "interactive") {
				showPageInteractive();
			}
		}
		
        function showPageLoading() {
			var strConfig = 'height=400,width=600, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=no';
            oWin = window.open('', 'newwindow', config = strConfig);
			var pageContent = createPageContent("../images/Image.JPG");
			oWin.document.write(pageContent);
			var count = 0;
			_pageWaitInterval = setInterval(function ()
			{
				count++;
				oWin.document.getElementById("lblSecond").textContent = "Page wait (s): " + count;
				if(count == _varPageWait/1000)
				{
					oWin.document.close();					
					clearInterval(_pageWaitInterval);
					var lblComment = oWin.document.getElementById("lblComment");					
					lblComment.textContent += oWin.document.readyState + " ";
					//timer objectwait
					_objectWaitInterval = setInterval(function ()
					{
						clearInterval(_objectWaitInterval);
						var objWaitContainer = oWin.document.getElementById("objWaitContainer");
						
						objWaitContainer.innerHTML = "<button type=\"button\" name=\"btnTest\" style=\"width:100px;height:50px;\" value=\"Apply\" onclick=\"buttonTest_Click();\"><p><font size=\"2\"> Button Test</font></p></button>";
						
					}, _varObjWait);
				}	
			}, 1000);
        }
		
		function showPageInteractive() {
			var strConfig = 'height=400,width=600, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=no';
            oWin = window.open('', 'newwindow', config = strConfig);
			var pageContent = createPageContent("http://www.google.com:81/");
			oWin.document.write(pageContent);
			oWin.document.close();
			var count = 0;
			_pageWaitInterval = setInterval(function () 
			{
				count++;
				oWin.document.getElementById("lblSecond").textContent = "Page wait (s): " + count;
				if(count == _varPageWait/1000)
				{
					clearInterval(_pageWaitInterval);
					
					//cancel image downloads
					if(oWin.stop !== undefined)
					{					
						 console.log("stop");
						 oWin.stop();
					}
					else if(oWin.document.execCommand !== undefined)/*for IE*/
					{
						console.log("command stop");
						oWin.document.execCommand("Stop", false);
						 
					}
					//
					oWin.document.getElementById("lblComment").textContent += oWin.document.readyState + " ";
					_objectWaitInterval = setInterval(function ()
					{
						clearInterval(_objectWaitInterval);
						var objWaitContainer = oWin.document.getElementById("objWaitContainer");
						
						objWaitContainer.innerHTML = "<button type=\"button\" name=\"btnTest\" style=\"width:100px;height:50px;\" value=\"Apply\" onclick=\"buttonTest_Click();\"><p><font size=\"2\"> Button Test</font></p></button>";
						
					}, _varObjWait);
				}
				
			}, 1000);
        }

        function createPageContent(imageSrc) {
            //page content
            var newPage = "<html><head><title>";
            newPage += "Timing settings";
            newPage += "</title></head><body>";

            newPage += "<img style=\"width:200px;\" src=\"" + imageSrc + "\" title=\"high_quality_img\" alt=\"High quality image\" id=\"image_Test\"><br>";
            newPage += "<span id=\"lblSecond\" name=\"lblSecond\" size=\"15\"></span><br>";
			newPage += "<span id=\"lblComment\" name=\"lblComment\" size=\"15\">Document Status: </span><br>";
			newPage += "<div id=\"objWaitContainer\"></div>";
			newPage += "<span id=\"lblTest\" size=\"15\"></span><br>";
            newPage += "<button type=\"button\" name=\"btnClose\" style=\"width:200px;top:50;left:50\" value=\"Close\" onclick=\"return window.close();\"><p><font size=\"5\"> Close</font></p></button>";
			newPage += 
			"<script>" +
				"document.onreadystatechange = onDocumentStateChange();" +
				"document.addEventListener('DOMContentLoaded', function() {console.log(\"DOM fully loaded and parsed\"); document.getElementById(\"lblComment\").textContent += document.readyState + \" \";});" + 
				"function buttonTest_Click() {document.getElementById(\"lblTest\").textContent = \"Button Test clicked.\";}" +
				"function onDocumentStateChange() {;console.log(document.readyState); document.getElementById(\"lblComment\").textContent += document.readyState + \" \"; }" + 
			"<\/script>";
            newPage += "</body></html>";
            return newPage;
        }

        function isInt(value) {
            return !isNaN(value) &&
                   parseInt(Number(value)) == value &&
                   !isNaN(parseInt(value, 10));
        }

    </script>
</body>
<!-- InstanceEnd -->
</html>
